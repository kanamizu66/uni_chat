# uni_chat
# 群聊功能实现文档

## 项目概述

本项目旨在实现一个包含店主与客户权限管理的群聊功能。客户可通过申请加入群聊与店主互动，店主和管理员具有管理群聊和客户权限的功能。以下是功能详细说明和实现设计。

---

## 功能清单

### 1. 用户功能
- **注册与登录**
  - 客户可以注册账户并提交身份信息。
  - 店主审核客户后，客户可加入对应的群聊。

- **聊天功能**
  - 支持文字、图片、链接消息。
  - 客户与店主仅能在指定群聊中互动。

- **群聊加入**
  - 客户申请加入店主的群聊，需店主审核通过。

### 2. 群主功能
- 审核客户申请。
- 删除群聊中的指定消息。

### 3. 管理员功能
- 禁用客户聊天权限。
- 转移客户至其他店主管理。
- 查看并管理群聊记录。

---

## 数据库设计

### 用户表（User）
| 字段名       | 类型       | 描述                       |
|--------------|------------|----------------------------|
| user_id      | INT        | 用户唯一标识              |
| name         | VARCHAR    | 用户名                    |
| role         | ENUM       | 用户角色（店主、客户）    |
| status       | ENUM       | 客户状态（待审核、已审核、禁用） |
| group_id     | INT        | 关联的群聊 ID             |
| owner_id     | INT        | 对应店主 ID              |

### 群聊表（GroupChat）
| 字段名       | 类型       | 描述                       |
|--------------|------------|----------------------------|
| group_id     | INT        | 群聊唯一标识              |
| group_name   | VARCHAR    | 群聊名称                  |
| owner_id     | INT        | 群主 ID                  |
| created_at   | DATETIME   | 创建时间                  |

### 消息表（Message）
| 字段名       | 类型       | 描述                       |
|--------------|------------|----------------------------|
| message_id   | INT        | 消息唯一标识              |
| group_id     | INT        | 所属群聊 ID               |
| sender_id    | INT        | 发送者 ID                 |
| message_type | ENUM       | 消息类型（文字、图片、链接） |
| content      | TEXT       | 消息内容                  |
| created_at   | DATETIME   | 发送时间                  |

### 后台操作记录表（AdminLogs）
| 字段名       | 类型       | 描述                       |
|--------------|------------|----------------------------|
| log_id       | INT        | 操作记录 ID               |
| admin_id     | INT        | 操作管理员 ID             |
| action       | VARCHAR    | 操作类型（禁用权限、客户转移） |
| details      | TEXT       | 操作详情                  |
| created_at   | DATETIME   | 操作时间                  |

---

## API 设计

### 用户相关接口
- `POST /api/register`  
  客户注册并提交身份信息。

- `POST /api/approve_customer`  
  店主审核客户身份。

### 群聊接口
- `POST /api/create_group`  
  创建群聊。

- `POST /api/join_group`  
  用户申请加入群聊。

- `POST /api/send_message`  
  发送消息（文字、图片、链接）。

- `DELETE /api/delete_message`  
  群主删除消息。

### 后台管理接口
- `POST /api/disable_chat`  
  禁用客户聊天权限。

- `POST /api/transfer_customer`  
  转移客户至其他店主。

---

## 功能流程

### 1. 客户加入群聊
1. 客户注册后，提交申请加入某个店主的群聊。
2. 店主在“我的”页面审核客户身份。
3. 审核通过后，客户加入对应的群聊。

### 2. 消息发送与管理
- 客户和店主可在群聊内发送文字、图片和链接消息。
- 群主有权限删除任何消息。

### 3. 后台管理操作
- 管理员可禁用客户的聊天权限。
- 管理员可将客户转移至其他店主名下，自动更新群聊权限。

---

## 前端界面设计

### **“我的”页面**
- 增加聊天功能入口，显示当前客户的群聊列表。

### **群聊界面**
- 聊天记录列表，支持消息类型区分。
- 输入框支持文本、图片、链接发送。

### **后台管理界面**
- 客户管理模块，支持禁用权限、查看聊天记录。
- 转移客户时，可选目标店主，自动更新客户群聊信息。

---

## 技术选型

- **前端vue
- **后端nodejs
